
#include "Types.h"
#include "Config.h"
#include "TwistyEnv.h"
#include "Network.h"
#include "Coach.h"

int main(int argc, char* argv[]) {
  const auto data = "o Cannon\n"
                    "l 13.0000 7.2261 133.5688 128.4615 -3.461539 2.461539 -0.000000 0.0000 0.0000 0.0030 1.0000\n"
                    "p 3.460694 -0.149279 0.000000 0.0000 0.0000 -0.0030 1.0000\n"
                    "p 4.462705 0.177960 -0.000000 1.0000 -0.0030 -0.0000 0.0000\n"
                    "p 5.460657 -0.161456 0.000000 0.0000 -0.0000 0.0030 -1.0000\n"
                    "p 2.462742 0.190137 0.000000 -1.0000 0.0030 -0.0000 0.0000\n"
                    "p 1.460731 -0.137102 -0.000000 -0.0000 0.0000 0.0030 -1.0000\n"
                    "p 0.462779 0.202314 0.000000 1.0000 -0.0030 0.0000 -0.0000\n"
                    "p -0.539232 -0.124924 -0.000000 0.0000 -0.0000 -0.0030 1.0000\n"
                    "p -1.537184 0.214491 0.000000 -1.0000 0.0030 -0.0000 0.0000\n"
                    "p -2.539195 -0.112747 -0.000000 -0.0000 0.0000 0.0030 -1.0000\n"
                    "p -2.539195 -0.112747 1.414214 -0.0000 0.0000 0.0030 -1.0000\n"
                    "p -2.539195 -0.112747 -1.414214 -0.0000 0.0000 0.0030 -1.0000\n"
                    "p -3.537147 0.226669 0.000000 1.0000 -0.0030 0.0000 -0.0000\n"
                    "p -4.539158 -0.100570 -0.000000 0.0000 -0.0000 -0.0030 1.0000\n"
                    "l 16.0000 26.3194 23.6528 34.6667 -0.000000 2.000000 2.504336 0.0000 0.0000 0.3827 0.9239\n"
                    "p 0.235702 0.235702 -1.090123 0.0000 0.0000 -0.3827 0.9239\n"
                    "p -0.000001 1.178511 -0.854420 -0.6533 0.2706 0.6533 -0.2706\n"
                    "p -0.235702 -0.235702 -1.090123 0.9239 -0.3827 -0.0000 0.0000\n"
                    "p 0.000000 -1.178511 -0.854420 -0.2706 0.6533 0.2706 -0.6533\n"
                    "p 0.235702 1.414214 0.088389 -0.2706 -0.6533 0.6533 -0.2706\n"
                    "p -0.235703 1.414213 0.559793 -0.2706 0.6533 0.6533 0.2706\n"
                    "p -1.178512 1.178511 0.324091 -0.0000 0.0000 -0.9239 0.3827\n"
                    "p 1.178511 1.178512 0.324091 -0.0000 0.0000 -0.9239 -0.3827\n"
                    "p 1.414213 0.235703 0.559793 0.2706 0.6533 0.2706 0.6533\n"
                    "p 1.414213 -0.235702 0.088389 0.6533 0.2706 -0.6533 -0.2706\n"
                    "p 1.178512 -1.178511 0.324091 0.0000 -0.0000 0.3827 0.9239\n"
                    "p 0.235703 -1.414213 0.559793 -0.6533 -0.2706 0.2706 -0.6533\n"
                    "p -0.235702 -1.414214 0.088388 -0.6533 0.2706 0.2706 0.6533\n"
                    "p -1.178511 -1.178512 0.324090 0.0000 0.0000 0.3827 -0.9239\n"
                    "p -1.414214 0.235702 0.088389 0.2706 -0.6533 0.2706 -0.6533\n"
                    "p -1.414213 -0.235703 0.559794 -0.6533 0.2706 0.6533 -0.2706\n"
                    "l 16.0000 26.3194 23.6528 34.6667 0.000000 2.000000 -2.504337 0.0000 0.0000 0.3827 0.9239\n"
                    "p 0.235702 0.235703 1.090123 0.0000 0.0000 -0.3827 0.9239\n"
                    "p -0.235702 -0.235703 1.090123 0.9239 -0.3827 -0.0000 0.0000\n"
                    "p -0.000002 1.178511 0.854421 -0.6533 0.2706 -0.6533 0.2706\n"
                    "p 0.000002 -1.178511 0.854421 0.2706 -0.6533 0.2706 -0.6533\n"
                    "p 0.235700 1.414214 -0.088388 0.2706 0.6533 0.6533 -0.2706\n"
                    "p 1.178510 1.178513 -0.324090 -0.0000 0.0000 0.9239 0.3827\n"
                    "p -0.235704 1.414213 -0.559793 -0.2706 0.6533 -0.6533 -0.2706\n"
                    "p -1.178513 1.178510 -0.324090 0.0000 -0.0000 -0.9239 0.3827\n"
                    "p -1.414214 0.235700 -0.088388 0.2706 -0.6533 -0.2706 0.6533\n"
                    "p -1.414213 -0.235704 -0.559793 0.6533 -0.2706 0.6533 -0.2706\n"
                    "p -1.178510 -1.178513 -0.324091 -0.0000 -0.0000 0.3827 -0.9239\n"
                    "p -0.235700 -1.414214 -0.088388 -0.6533 0.2706 -0.2706 -0.6533\n"
                    "p 0.235704 -1.414213 -0.559793 -0.6533 -0.2706 -0.2706 0.6533\n"
                    "p 1.178513 -1.178510 -0.324091 -0.0000 0.0000 0.3827 0.9239\n"
                    "p 1.414214 -0.235700 -0.088389 0.6533 0.2706 0.6533 0.2706\n"
                    "p 1.414213 0.235704 -0.559793 0.2706 0.6533 -0.2706 -0.6533\n"
                    "j 0 1 -180.00 180.00 1000.00 0.000000 2.416667 0.707107 0.0000 -0.7071 0.0000 0.7071\n"
                    "j 0 2 -180.00 180.00 1000.00 0.000000 2.416667 -0.707107 0.0000 0.7071 0.0000 0.7071\n"
                    "b 0";
  const auto environment = std::make_shared<TwistyEnv>(data);

  const auto observationLength = environment->observation.size();
  if ((observationLength == 0) || (environment->actionLength == 0)) {
    return 1;
  }

  Config config;
  const auto network = std::make_shared<Network>(config, observationLength, environment->actionLength);

  Coach coach(config, environment, network);

  coach.run();
}
